(window.webpackJsonp=window.webpackJsonp||[]).push([[249],{661:function(e,s,a){"use strict";a.r(s);var _=a(42),t=Object(_.a)({},(function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"mysql密码安全性修改"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysql密码安全性修改"}},[e._v("#")]),e._v(" mysql密码安全性修改")]),e._v(" "),a("p",[e._v("ERROR 1819 (HY000): Your password does not satisfy the current policy requirements，出现这个问题怎么办？不用着急，下面给出答案。")]),e._v(" "),a("p",[e._v("为了加强安全性，MySQL5.7 为 root 用户随机生成了一个密码，在 error log 中，关于 error log 的位置，如果安装的是 RPM 包，则默认是 / var/log/mysqld.log。")]),e._v(" "),a("p",[e._v("一般可通过 log_error 设置")]),e._v(" "),a("p",[e._v('mysql> select @@log_error;\n+---------------------+\n| @@log_error     |\n+---------------------+\n| /var/log/mysqld.log |\n+---------------------+\n1 row in set (0.00 sec)\n可通过# grep "password" /var/log/mysqld.log 命令获取 MySQL 的临时密码')]),e._v(" "),a("p",[e._v("复制代码 代码如下:\n2016-01-19T05:16:36.218234Z 1 [Note] A temporary password is generated for root@localhost: waQ,qR%be2(5\n用该密码登录到服务端后，必须马上修改密码，不然会报如下错误：")]),e._v(" "),a("p",[e._v("mysql> select user();\nERROR 1820 (HY000): You must reset your password using ALTER USER statement before executing this statement.\n如果只是修改为一个简单的密码，会报以下错误：")]),e._v(" "),a("p",[e._v("mysql> ALTER USER USER() IDENTIFIED BY '12345678';\nERROR 1819 (HY000): Your password does not satisfy the current policy requirements\n这个其实与 validate_password_policy 的值有关。")]),e._v(" "),a("p",[e._v("validate_password_policy 有以下取值：")]),e._v(" "),a("p",[e._v("默认是 1，即 MEDIUM，所以刚开始设置的密码必须符合长度，且必须含有数字，小写或大写字母，特殊字符。")]),e._v(" "),a("p",[e._v("有时候，只是为了自己测试，不想密码设置得那么复杂，譬如说，我只想设置 root 的密码为 123456。")]),e._v(" "),a("p",[e._v("必须修改两个全局参数：")]),e._v(" "),a("p",[e._v("首先，修改 validate_password_policy 参数的值")]),e._v(" "),a("p",[e._v("mysql> set global validate_password_policy=0;\nQuery OK, 0 rows affected (0.00 sec)\n这样，判断密码的标准就基于密码的长度了。这个由 validate_password_length 参数来决定。")]),e._v(" "),a("p",[e._v("mysql> select @@validate_password_length;\n+----------------------------+\n| @@validate_password_length |\n+----------------------------+\n|             8 |\n+----------------------------+\n1 row in set (0.00 sec)\nvalidate_password_length 参数默认为 8，它有最小值的限制，最小值为：")]),e._v(" "),a("p",[e._v("validate_password_number_count")]),e._v(" "),a("ul",[a("li",[e._v("validate_password_special_char_count")]),e._v(" "),a("li",[e._v("(2 * validate_password_mixed_case_count)\n其中，validate_password_number_count 指定了密码中数据的长度，validate_password_special_char_count 指定了密码中特殊字符的长度，validate_password_mixed_case_count 指定了密码中大小字母的长度。")])]),e._v(" "),a("p",[e._v("这些参数，默认值均为 1，所以 validate_password_length 最小值为 4，如果你显性指定 validate_password_length 的值小于 4，尽管不会报错，但 validate_password_length 的值将设为 4。如下所示：")]),e._v(" "),a("p",[e._v("mysql> select @@validate_password_length;\n+----------------------------+\n| @@validate_password_length |\n+----------------------------+\n|             8 |\n+----------------------------+\n1 row in set (0.00 sec)")]),e._v(" "),a("p",[e._v("mysql> set global validate_password_length=1;\nQuery OK, 0 rows affected (0.00 sec)")]),e._v(" "),a("p",[e._v("mysql> select @@validate_password_length;\n+----------------------------+\n| @@validate_password_length |\n+----------------------------+\n|             4 |\n+----------------------------+\n1 row in set (0.00 sec)")]),e._v(" "),a("p",[e._v("如果修改了 validate_password_number_count，validate_password_special_char_count，validate_password_mixed_case_count 中任何一个值，则 validate_password_length 将进行动态修改。")]),e._v(" "),a("p",[e._v("mysql> select @@validate_password_length;\n+----------------------------+\n| @@validate_password_length |\n+----------------------------+\n|             4 |\n+----------------------------+\n1 row in set (0.00 sec)")]),e._v(" "),a("p",[e._v("mysql> select @@validate_password_mixed_case_count;\n+--------------------------------------+\n| @@validate_password_mixed_case_count |\n+--------------------------------------+\n|                  1 |\n+--------------------------------------+\n1 row in set (0.00 sec)")]),e._v(" "),a("p",[e._v("mysql> set global validate_password_mixed_case_count=2;\nQuery OK, 0 rows affected (0.00 sec)")]),e._v(" "),a("p",[e._v("mysql> select @@validate_password_mixed_case_count;\n+--------------------------------------+\n| @@validate_password_mixed_case_count |\n+--------------------------------------+\n|                  2 |\n+--------------------------------------+\n1 row in set (0.00 sec)")]),e._v(" "),a("p",[e._v("mysql> select @@validate_password_length;\n+----------------------------+\n| @@validate_password_length |\n+----------------------------+\n|             6 |\n+----------------------------+\n1 row in set (0.00 sec)")]),e._v(" "),a("p",[e._v("当然，前提是 validate_password 插件必须已经安装，MySQL5.7 是默认安装的。")]),e._v(" "),a("p",[e._v("那么如何验证 validate_password 插件是否安装呢？可通过查看以下参数，如果没有安装，则输出将为空。")]),e._v(" "),a("p",[e._v("mysql> SHOW VARIABLES LIKE 'validate_password%';\n+--------------------------------------+-------+\n| Variable_name            | Value |\n+--------------------------------------+-------+\n| validate_password_dictionary_file  |    |\n| validate_password_length       | 6   |\n| validate_password_mixed_case_count  | 2   |\n| validate_password_number_count    | 1   |\n| validate_password_policy       | LOW  |\n| validate_password_special_char_count | 1   |\n+--------------------------------------+-------+\n6 rows in set (0.00 sec)")]),e._v(" "),a("p",[a("a",{attrs:{href:"https://www.jb51.net/article/95399.htm",target:"_blank",rel:"noopener noreferrer"}},[e._v("参考地址"),a("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=t.exports}}]);